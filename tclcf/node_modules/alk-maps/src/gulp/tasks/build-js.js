var config = require('../gulp-config')
var gulp = require('gulp')
var browserify = require('browserify')
var source = require('vinyl-source-stream')
var gutil = require('gulp-util')

function buildJs(handleErrors) {
    var bundler = browserify(config.paths.src.js).bundle()

    if (handleErrors) {
        bundler.on('error', function(err) {
            gutil.log(gutil.colors.red('Browserify error:'), gutil.colors.yellow(err.message))
        })
    }

    bundler
        .pipe(source(config.paths.dist.bundleName))
        .pipe(gulp.dest(config.paths.dist.root))
}

gulp.task('build-js', function() {
    buildJs(false)
})
gulp.task('build-js:handleErrors', function() {
    buildJs(true)
})
