var LayerApi = require('./LayerApi')

module.exports = function(ALKMaps, map, options) {

    var layer = new ALKMaps.Layer.HeatMap(options.layerName || 'HeatMap Layer')

    var heatMapStyle = options.heatMapStyle || {
            pointRadius: 15,
            opacity: 0.85,
            colorGradient: [
                [0.2, '#0000ff'],
                [0.5, '#00ffff'],
                [0.6, '#00ff00'],
                [0.95, '#ffff00'],
                [1, '#ff0000']
            ]
        }
    layer.updateOptions(heatMapStyle)

    map.addLayer(layer)

    //API related stuff
    var api = new LayerApi(ALKMaps, map, layer, null, options)

    var points = []
    api.addItem = function(item) {
        var lonLat = api.createLonLat(item.location.lon, item.location.lat)
        points.push(lonLat)
    }

    api.doneAddingItems = function() {
        layer.setPoints(points)
    }

    api.clearItems = function() {
        layer.clearPoints()
    }

    return api
}
