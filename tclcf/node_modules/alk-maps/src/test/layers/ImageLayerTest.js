describe('ImageLayer', function() {
    var ImageLayer
    var ALKMaps
    var map
    var VectorLayer
    var ImageLayerStyle
    var api
    var style
    var options

    beforeEach(function() {
        ALKMaps = new MockALKMaps()
        map = new MockMap()

        api = { api: true }
        style = {
            style: true,
            defaultStyle: {},
            clone: function() {
                style.cloned = true
                return style
            }
        }
        options = { options: true }
        VectorLayer = sinon.stub().returns(api)
        ImageLayerStyle = sinon.stub().returns(style)

        ImageLayer = proxyquire('../main/layers/ImageLayer', {
            './VectorLayer': VectorLayer,
            './styles/ImageLayerStyle': ImageLayerStyle
        })
    })

    it('should be a styled vector layer', function() {
        var ImageLayerApi = new ImageLayer(ALKMaps, map, options)

        ImageLayerStyle.should.have.been.calledWith(ALKMaps, options)
        options.defaultStyle.should.equal(style)
        VectorLayer.should.have.been.calledWith(ALKMaps, map, options)
        ImageLayerApi.should.equal(api)
    })

    it('should honor provided style', function() {
        options.defaultStyle = style
        options.selectedStyle = style

        var ImageLayerApi = new ImageLayer(ALKMaps, map, options)

        ImageLayerStyle.should.not.have.been.called
        options.defaultStyle.should.equal(style)
        options.selectedStyle.should.equal(style)
        VectorLayer.should.have.been.calledWith(ALKMaps, map, options)
        ImageLayerApi.should.equal(api)
    })
})
