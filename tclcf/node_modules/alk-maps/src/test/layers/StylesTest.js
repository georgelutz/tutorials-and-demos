describe('style', function() {
    var ALKMaps
    var options
    var validKeys = [
        'strokeColor',
        'pointRadius',
        'strokeWidth',
        'fillColor',
        'fontSize',
        'fontColor',
        'label',
        'graphicName',
        'externalGraphic',
        'graphicWidth',
        'graphicHeight',
        'graphicXOffset',
        'graphicYOffset',
        'rotation',
        'labelYOffset',
        'fillOpacity',
        'cursor'
    ]

    beforeEach(function() {
        ALKMaps = new MockALKMaps()
        ALKMaps.Style = function(style, handlers) {
            return {
                style: style,
                handlers: handlers
            }
        }
        options = {}
    })

    var re = /^\${(.+)}$/
    function validateStyle(input) {
        var usedHandlers = []

        var styleKeys = _.keys(input.style)
        _.each(styleKeys, function(key) {
            validKeys.should.contain(key)

            var match
            if (_.isString(input.style[key]) && (match = re.exec(input.style[key])) != null) {
                input.handlers.context.should.have.property(match[1]).that.is.a('function')
                usedHandlers.push(match[1])
            }
        })

        var handlerKeys = _.keys(input.handlers.context)
        _.each(handlerKeys, function(key) {
            usedHandlers.should.contain(key)
            input.handlers.context[key].should.be.a('function')

            input.handlers.context[key]({
                cluster: false,
                attributes: {}
            }).should.not.equal(null)

            input.handlers.context[key]({
                cluster: [1, 2, 3],
                attributes: {}
            }).should.not.equal(null)
        })
    }

    it('VehicleLayerStyle should be valid', function() {
        var VehicleLayerStyle = require('../../main/layers/styles/VehicleLayerStyle')
        var style = new VehicleLayerStyle(ALKMaps, options)
        validateStyle(style)
    })

    it('LandmarkLayerStyle should be valid', function() {
        var LandmarkLayerStyle = require('../../main/layers/styles/LandmarkLayerStyle')
        var style = new LandmarkLayerStyle(ALKMaps, options)
        validateStyle(style)
    })

    it('ImageLayerStyle should be valid', function() {
        var ImageLayerStyle = require('../../main/layers/styles/ImageLayerStyle')
        var style = new ImageLayerStyle(ALKMaps, options)
        validateStyle(style)
    })
})
