describe('TrafficLayer', function() {
    var TrafficLayer
    var ALKMaps
    var LayerApi
    var map

    beforeEach(function() {
        ALKMaps = new MockALKMaps()
        map = new MockMap()
        LayerApi = new MockLayerApi()

        TrafficLayer = proxyquire('../main/layers/TrafficLayer', {
            './LayerApi': LayerApi.constructor
        })
    })

    it('should create a traffic layer', function() {
        var layer = { abc: 123 }
        ALKMaps.Layer.Traffic.returns(layer)

        var trafficLayerApi = new TrafficLayer(ALKMaps, map, {})

        trafficLayerApi.should.equal(LayerApi.api)
        map.addLayer.should.have.been.calledWith(layer)
        ALKMaps.Layer.Traffic.should.have.been.calledWith('Traffic Layer', { region: 'NA' }, {})
    })

    it('should support options', function() {
        var layer = { abc: 123 }
        ALKMaps.Layer.Traffic.returns(layer)
        var options = {
            layerName: 'namey',
            region: 'regiony'
        }

        var trafficLayerApi = new TrafficLayer(ALKMaps, map, options)

        trafficLayerApi.should.equal(LayerApi.api)
        map.addLayer.should.have.been.calledWith(layer)
        ALKMaps.Layer.Traffic.should.have.been.calledWith(options.layerName, { region: options.region }, {})
    })
})
