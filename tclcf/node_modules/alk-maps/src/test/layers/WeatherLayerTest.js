describe('WeatherLayer', function() {
    var WeatherLayer
    var ALKMaps
    var LayerApi
    var map

    beforeEach(function() {
        ALKMaps = new MockALKMaps()
        map = new MockMap()
        LayerApi = new MockLayerApi()

        WeatherLayer = proxyquire('../main/layers/WeatherLayer', {
            './LayerApi': LayerApi.constructor
        })
    })

    it('should create a weather layer', function() {
        var layer = { abc: 123 }
        ALKMaps.Layer.WeatherRadar.returns(layer)

        var WeatherLayerApi = new WeatherLayer(ALKMaps, map, {})

        WeatherLayerApi.should.equal(LayerApi.api)
        map.addLayer.should.have.been.calledWith(layer)
        ALKMaps.Layer.WeatherRadar.should.have.been.calledWith('Weather Layer', { display: 'satellite' }, { opacity: 0.5 })
    })

    it('should support options', function() {
        var layer = { abc: 123 }
        ALKMaps.Layer.WeatherRadar.returns(layer)
        var options = {
            layerName: 'namey',
            display: 'displayThing',
            opacity: 123
        }

        var WeatherLayerApi = new WeatherLayer(ALKMaps, map, options)

        WeatherLayerApi.should.equal(LayerApi.api)
        map.addLayer.should.have.been.calledWith(layer)
        ALKMaps.Layer.WeatherRadar.should.have.been.calledWith(options.layerName, { display: options.display }, { opacity: options.opacity })
    })
})
