const _ = require('lodash')

module.exports = {

    getConfig: () => require('./defaultConfig'),

    getWebpackConfig: () => require('./webpack.config'),

    getWebpackProdConfig: () => require('./webpack.prod.config'),

    importTasks: (gulp, config, isPortal) => {
        let tasks = require('require-directory')(module, './tasks')
        if (isPortal) {
            let portalTasks = require('require-directory')(module, './portalTasks')
            tasks = _.merge(tasks, portalTasks)
        }

        _.forIn(tasks, (task, key) => {
            if (_.isFunction(task)) {
                gulp.task(key, [], done => task(gulp, config, done))
            } else if (_.isArray(task)) {
                gulp.task(key, task)
            } else if (_.isObject(task)) {
                gulp.task(key, task.dependencies, done => task.task(gulp, config, done))
            }
        })
    }
}
