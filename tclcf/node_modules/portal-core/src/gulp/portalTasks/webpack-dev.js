module.exports = (gulp, config, cb) => {
    const webpack = require('webpack')
    const WebpackDevServer = require('webpack-dev-server')
    const webpackConfig = require('../webpack.config')

    //add inline reloading
    webpackConfig.entry.app.unshift('webpack-dev-server/client?http://localhost:9000/')
    webpackConfig.entry.app.unshift('webpack/hot/dev-server')

    webpackConfig.plugins.unshift(new webpack.HotModuleReplacementPlugin())

    webpackConfig.debug = true
    webpackConfig.devtool = 'eval'

    const webpackCompiler = webpack(webpackConfig)
    new WebpackDevServer(webpackCompiler, {
        hot: true,
        contentBase: config.dist,
        stats: {
            colors: true
        }
    }).listen(9000, 'localhost', err => err ? cb(err) : '')
}
