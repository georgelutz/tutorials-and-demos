const webpack = require('webpack')
const config = require('./webpack.config')

config.debug = false
config.bail = true

//css minify
const postCssConfig = config.postcss()
config.postcss = () => (postCssConfig.concat([

    //remove comments
    require('postcss-discard-comments')(),

    //minify
    require('cssnano')({
        safe: true,
        discardEmpty: false /* broken on node 6 for now */
    })

]))

//optimize
config.plugins.push(new webpack.optimize.DedupePlugin())
config.plugins.push(new webpack.optimize.UglifyJsPlugin({
    compress: {
        warnings: false
    }
}))

module.exports = config
