module.exports = {
    template: require('../views/fieldError.html'),
    require: {
        form: '^form'
    },
    bindings: {
        field: '@'
    },
    controller: class FieldError {
        /* @ngInject */
        constructor(fieldErrorService) {
            this.service = fieldErrorService
        }

        $onInit() {
            this.hideServerError = this.form.$error.$invalid

            if (this.form[this.field]) {
                this.form[this.field].$parsers.push(value => {
                    this.service.clearError(this.field)
                    return value
                })
            }
        }
    }
}
