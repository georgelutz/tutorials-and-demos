module.exports = /* @ngInject */
    function(googleAnalyticsService, $rootScope, authService) {
        googleAnalyticsService.setAccount()
        googleAnalyticsService.forceSSL()

        $rootScope.$on('login', () => {
            return authService.getCurrentUser()
                .then(user => {
                    if (!user.anonymous) {
                        googleAnalyticsService.setAccount(user.uid)
                        googleAnalyticsService.setCustomDimension('dimension1', user.orgType)
                        googleAnalyticsService.setCustomDimension('dimension3', user.userRoles[0].name)
                        googleAnalyticsService.setCustomDimension('dimension4', user.orgId)
                    }
                })
        })
    }
