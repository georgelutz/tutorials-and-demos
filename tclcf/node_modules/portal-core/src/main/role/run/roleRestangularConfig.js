module.exports = /* @ngInject */
    function($log, Restangular, dialogService, toastService) {
        Restangular.addElementTransformer('roles', false, role => {

            if (role.id) {
                role.key = role.id
            }

            role.confirmDelete = function(event) {
                var confirmDeleteOptions = {
                    entityName: role.name,
                    targetEvent: event
                }

                return dialogService.showConfirmDelete(confirmDeleteOptions)
                    .then(() => role.remove())
                    .then(() => {
                        role.deleted = true
                        return role
                    })
                    .catch(err => {
                        if (err) {
                            $log.error('Error deleting role', err)
                            toastService.show('Error deleting role', {theme: 'warn'})
                        }
                    })
            }

            return role
        })
    }
