var _ = require('lodash')

module.exports = /* @ngInject */
    function(globalSearchProvider) {

        //add to global search
        globalSearchProvider.addCommonSearchFunction('entities', 'search')
        globalSearchProvider
            .addSearchItem('user', 'nav.user.list', data => {
                var users = _.get(data, 'user.data')
                return _.map(users, user => ({
                    icon: 'person',
                    name: [
                        _.get(user, 'firstName', ''),
                        _.get(user, 'lastName', ''),
                        _.get(user, 'userName', '')
                    ].join(' ').trim(), type: 'user', key: user.id
                }))
            }, (value, $state) => {
                if (value.type === 'user') {
                    $state.go('nav.user.details', {id: value.key}, {reload: true})
                    return true
                }
            }, 'user.common.type')

        //static page search
        globalSearchProvider.addStaticPage('Add User', ['add user', 'user add'], 'ROLE_USER.+_WRITE', 'nav.user.add')
        globalSearchProvider.addStaticPage('List Users', ['list users', 'user list'], 'ROLE_USER.+_READ', 'nav.user.list')
    }
