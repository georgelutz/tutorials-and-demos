describe('sortableHeaderDirective', () => {
    var sortableHeaderDirective
    var $scope
    var $stateParams
    var $state
    var directive

    beforeEach(() => {
        $scope = {sortableHeader:'dsn'}
        $stateParams = {sort:'dsn'}
        $state = {go:sinon.stub(), current:{name:'list'}}

        directive = require('../../../main/core/directives/sortableHeaderDirective')()
        sortableHeaderDirective = new directive.controller($stateParams, $state, $scope)
    })

    it('should initialize', () => {
        sortableHeaderDirective.$onInit()

        sortableHeaderDirective.currentSort.should.equal('dsn')
        sortableHeaderDirective.sortDirection.should.equal('+')
    })

    it('should handle descending sort', () => {

        $stateParams = {sort:'-dsn'}

        directive = require('../../../main/core/directives/sortableHeaderDirective')()
        sortableHeaderDirective = new directive.controller($stateParams, $state, $scope)
        sortableHeaderDirective.$onInit()

        sortableHeaderDirective.currentSort.should.equal('dsn')
        sortableHeaderDirective.sortDirection.should.equal('-')
    })

    it('should handle perform sort', () => {

        $stateParams = {sort:'dsn'}

        directive = require('../../../main/core/directives/sortableHeaderDirective')()
        sortableHeaderDirective = new directive.controller($stateParams, $state, $scope)
        sortableHeaderDirective.$onInit()

        sortableHeaderDirective.performSort()

        $state.go.should.have.been.calledWith('list', {sort:'-dsn'}, {reload: true})
    })

    it('should handle perform sort toggle', () => {

        $stateParams = {sort:'-dsn'}

        directive = require('../../../main/core/directives/sortableHeaderDirective')()
        sortableHeaderDirective = new directive.controller($stateParams, $state, $scope)

        sortableHeaderDirective.performSort()

        $state.go.should.have.been.calledWith('list', {sort:'dsn'}, {reload: true})
    })

    it('should handle perform new sort', () => {

        $stateParams = {sort:'dsn'}
        $scope = {sortableHeader:'vin'}

        directive = require('../../../main/core/directives/sortableHeaderDirective')()
        sortableHeaderDirective = new directive.controller($stateParams, $state, $scope)

        sortableHeaderDirective.performSort()

        $state.go.should.have.been.calledWith('list', {sort:'vin'}, {reload: true})
    })
})

