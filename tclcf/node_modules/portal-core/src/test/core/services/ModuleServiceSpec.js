const proxyquire = require('proxyquire').noCallThru()

describe('moduleService', () => {
    let svc
    let angular = {}

    beforeEach(() => {
        let ModuleService = proxyquire('../../../main/core/services/ModuleService', {angular: angular})
        svc = new ModuleService()
    })

    it('should support validation for loaded modules', () => {
        angular.module = sinon.stub()

        svc.isModuleLoaded('some-loaded-module').should.equal(true)
        angular.module.should.have.been.calledWith('some-loaded-module')
        angular.module.callCount.should.equal(1)
    })

    it('should support validation for non loaded modules', () => {
        let error = {err: 'module not found error'}
        angular.module = sinon.stub().throws(error)

        svc.isModuleLoaded('some-not-loaded-module').should.equal(false)
        angular.module.should.have.been.calledWith('some-not-loaded-module')
        angular.module.callCount.should.equal(1)
    })

})
